#!/usr/bin/env node

const { Command, ContextHelpers, ImbaRepl } = require('../lib');
const os = require('os');
const path = require('path');

class ReplCommand extends Command {
	async handle() {
		const repl = new ImbaRepl('>>> ', path.join(os.homedir(), '.imba_shell_history'));

		repl.registerCallback((ctx) => {
			Object.keys(ContextHelpers).forEach((key) => {
				ctx[key] = ContextHelpers[key];
			});
		});

		await repl.run({ ignoreUndefined: true });
	}
}

(new ReplCommand).run();
